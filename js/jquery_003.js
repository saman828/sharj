(function(n){var i="keypad",t;n.JQPlugin.createPlugin({name:i,defaultOptions:{showOn:"focus",buttonImage:"",buttonImageOnly:!1,showAnim:"show",showOptions:null,duration:"normal",appendText:"",useThemeRoller:!1,keypadClass:"",prompt:"",layout:[],separator:"",target:null,keypadOnly:!0,randomiseAlphabetic:!1,randomiseNumeric:!1,randomiseOther:!1,randomiseAll:!1,beforeShow:null,onKeypress:null,onClose:null},regionalOptions:{"":{buttonText:"...",buttonStatus:"Open the keypad",closeText:"Close",closeStatus:"Close the keypad",clearText:"Clear",clearStatus:"Erase all the text",backText:"Back",backStatus:"Erase the previous character",spacebarText:"&#160;",spacebarStatus:"Space",enterText:"Enter",enterStatus:"Carriage return",tabText:"→",tabStatus:"Horizontal tab",shiftText:"Shift",shiftStatus:"Toggle upper/lower case characters",alphabeticLayout:[],fullLayout:[],isAlphabetic:null,isNumeric:null,toUpper:null,isRTL:!1}},_getters:["isDisabled"],_curInst:null,_disabledFields:[],_keypadShowing:!1,_keyCode:0,_specialKeys:[],_mainDivClass:i+"-popup",_inlineClass:i+"-inline",_appendClass:i+"-append",_triggerClass:i+"-trigger",_disableClass:i+"-disabled",_inlineEntryClass:i+"-keyentry",_rtlClass:i+"-rtl",_rowClass:i+"-row",_promptClass:i+"-prompt",_specialClass:i+"-special",_namePrefixClass:i+"-",_keyClass:i+"-key",_keyDownClass:i+"-key-down",qwertyAlphabetic:["qwertyuiop","asdfghjkl","zxcvbnm"],qwertyLayout:["!@#$%^&*()_="+this.HALF_SPACE+this.SPACE+this.CLOSE,this.HALF_SPACE+"`~[]{}<>\\|/"+this.SPACE+"789","qwertyuiop'\""+this.HALF_SPACE+"456",this.HALF_SPACE+"asdfghjkl;:"+this.SPACE+"123",this.SPACE+"zxcvbnm,.?"+this.SPACE+this.HALF_SPACE+"-0+",""+this.TAB+this.ENTER+this.SPACE_BAR+this.SHIFT+this.HALF_SPACE+this.BACK+this.CLEAR],addKeyDef:function(n,t,i,r){if(this._keyCode==32)throw"Only 32 special keys allowed";return this[n]=String.fromCharCode(this._keyCode++),this._specialKeys.push({code:this[n],id:n,name:t,action:i,noHighlight:r}),this},_init:function(){this.mainDiv=n('<div class="'+this._mainDivClass+'" style="display: none;"><\/div>');this._super()},_instSettings:function(i){var r=!i[0].nodeName.toLowerCase().match(/input|textarea/);return{_inline:r,ucase:!1,_mainDiv:r?n('<div class="'+this._inlineClass+'"><\/div>'):t.mainDiv}},_postAttach:function(n,t){if(t._inline){n.append(t._mainDiv).on("click."+t.name,function(){t._input.focus()});this._updateKeypad(t)}else n.is(":disabled")&&this.disable(n)},_setInput:function(t,i){i._input=n(i._inline?i.options.target||'<input type="text" class="'+this._inlineEntryClass+'" disabled/>':t);i._inline&&(t.find("input").remove(),i.options.target||t.append(i._input))},_optionsChanged:function(i,r,u){var e;if(n.extend(r.options,u),i.off("."+r.name).siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove(),e=r.options.appendText,e&&i[r.options.isRTL?"before":"after"]('<span class="'+this._appendClass+'">'+e+"<\/span>"),!r._inline){if(r.options.showOn=="focus"||r.options.showOn=="both")i.on("focus."+r.name,this.show).on("keydown."+r.name,this._doKeyDown);if(r.options.showOn=="button"||r.options.showOn=="both"){var f=r.options.buttonStatus,o=r.options.buttonImage,s=n(r.options.buttonImageOnly?n('<img src="'+o+'" alt="'+f+'" title="'+f+'"/>'):n('<button type="button" title="'+f+'"><\/button>').html(o==""?r.options.buttonText:n('<img src="'+o+'" alt="'+f+'" title="'+f+'"/>')));i[r.options.isRTL?"before":"after"](s);s.addClass(this._triggerClass).click(function(){return t._keypadShowing&&t._lastField==i[0]?t.hide():t.show(i[0]),!1})}}r.saveReadonly=i.attr("readonly");i[r.options.keypadOnly?"attr":"removeAttr"]("readonly",!0).on("setData."+r.name,function(n,t,i){r.options[t]=i}).on("getData."+r.name,function(n,t){return r.options[t]});this._setInput(i,r);this._updateKeypad(r)},_preDestroy:function(n,t){this._curInst==t&&this.hide();n.siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().prev("."+this._inlineEntryClass).remove();n.empty().off("."+t.name)[t.saveReadonly?"attr":"removeAttr"]("readonly",!0);t._input.removeData(t.name)},enable:function(t){if(t=n(t),t.hasClass(this._getMarker())){var i=t[0].nodeName.toLowerCase();i.match(/input|textarea/)?t.prop("disabled",!1).siblings("button."+this._triggerClass).prop("disabled",!1).end().siblings("img."+this._triggerClass).css({opacity:"1.0",cursor:""}):i.match(/div|span/)&&(t.children("."+this._disableClass).remove(),this._getInst(t)._mainDiv.find("button").prop("disabled",!1));this._disabledFields=n.map(this._disabledFields,function(n){return n==t[0]?null:n})}},disable:function(t){var r;if(t=n(t),t.hasClass(this._getMarker())){if(r=t[0].nodeName.toLowerCase(),r.match(/input|textarea/))t.prop("disabled",!0).siblings("button."+this._triggerClass).prop("disabled",!0).end().siblings("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});else if(r.match(/div|span/)){var i=t.children("."+this._inlineClass),f=i.offset(),u={left:0,top:0};i.parents().each(function(){if(n(this).css("position")=="relative")return u=n(this).offset(),!1});t.prepend('<div class="'+this._disableClass+'" style="width: '+i.outerWidth()+"px; height: "+i.outerHeight()+"px; left: "+(f.left-u.left)+"px; top: "+(f.top-u.top)+'px;"><\/div>');this._getInst(t)._mainDiv.find("button").prop("disabled",!0)}this._disabledFields=n.map(this._disabledFields,function(n){return n==t[0]?null:n});this._disabledFields[this._disabledFields.length]=t[0]}},isDisabled:function(t){return t&&n.inArray(t,this._disabledFields)>-1},show:function(i){var r,u,f,o,s;if(i=i.target||i,!t.isDisabled(i)&&t._lastField!=i){r=t._getInst(i);t.hide(null,"");t._lastField=i;t._pos=t._findPos(i);t._pos[1]+=i.offsetHeight;u=!1;n(i).parents().each(function(){return u|=n(this).css("position")=="fixed",!u});f={left:t._pos[0],top:t._pos[1]};t._pos=null;r._mainDiv.css({position:"absolute",display:"block",top:"-1000px",width:"auto"});t._updateKeypad(r);f=t._checkOffset(r,f,u);r._mainDiv.css({position:u?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});var h=r.options.duration,e=r.options.showAnim,c=function(){t._keypadShowing=!0};if(n.effects&&(n.effects[e]||n.effects.effect&&n.effects.effect[e])){o=r._mainDiv.data();for(s in o)s.match(/^ec\.storage\./)&&(o[s]=r._mainDiv.css(s.replace(/ec\.storage\./,"")));r._mainDiv.data(o).show(e,r.options.showOptions||{},h,c)}else r._mainDiv[e||"show"](e?h:0,c);r._input[0].type!="hidden"&&r._input[0].focus();t._curInst=r}},_updateKeypad:function(t){var i=this._getBorders(t._mainDiv);t._mainDiv.empty().append(this._generateHTML(t)).removeClass().addClass(t.options.keypadClass+(t.options.useThemeRoller?" ui-widget ui-widget-content":"")+(t.options.isRTL?" "+this._rtlClass:"")+" "+(t._inline?this._inlineClass:this._mainDivClass));n.isFunction(t.options.beforeShow)&&t.options.beforeShow.apply(t._input?t._input[0]:null,[t._mainDiv,t])},_getBorders:function(n){var t=function(n){return{thin:1,medium:3,thick:5}[n]||n};return[parseFloat(t(n.css("border-left-width"))),parseFloat(t(n.css("border-top-width")))]},_checkOffset:function(t,i,r){var o=t._input?this._findPos(t._input[0]):null,s=window.innerWidth||document.documentElement.clientWidth,h=window.innerHeight||document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,f=document.documentElement.scrollTop||document.body.scrollTop,e=0;return t._mainDiv.find(":not(div)").each(function(){e=Math.max(e,this.offsetLeft+n(this).outerWidth(!0))}),t._mainDiv.css("width",e+1),i.left=t.options.isRTL||i.left+t._mainDiv.outerWidth()-u>s?Math.max(r?0:u,o[0]+(t._input?t._input.outerWidth():0)-(r?u:0)-t._mainDiv.outerWidth()):Math.max(r?0:u,i.left-(r?u:0)),i.top=i.top+t._mainDiv.outerHeight()-f>h?Math.max(r?0:f,o[1]-(r?f:0)-t._mainDiv.outerHeight()):Math.max(r?0:f,i.top-(r?f:0)),i},_findPos:function(t){while(t&&(t.type=="hidden"||t.nodeType!=1))t=t.nextSibling;var i=n(t).offset();return[i.left,i.top]},hide:function(t,i){var r=this._curInst,u;r&&(!t||r==n.data(t,this.name))&&(this._keypadShowing&&(i=i!=null?i:r.options.duration,u=r.options.showAnim,n.effects&&(n.effects[u]||n.effects.effect&&n.effects.effect[u])?r._mainDiv.hide(u,r.options.showOptions||{},i):r._mainDiv[u=="slideDown"?"slideUp":u=="fadeIn"?"fadeOut":"hide"](u?i:0)),n.isFunction(r.options.onClose)&&r.options.onClose.apply(r._input?r._input[0]:null,[r._input.val(),r]),this._keypadShowing&&(this._keypadShowing=!1,this._lastField=null),r._inline&&r._input.val(""),this._curInst=null)},_doKeyDown:function(n){n.keyCode==9&&(t.mainDiv.stop(!0,!0),t.hide())},_checkExternalClick:function(i){if(t._curInst){var r=n(i.target);r.closest("."+t._mainDivClass).length===0&&!r.hasClass(t._getMarker())&&r.closest("."+t._triggerClass).length===0&&t._keypadShowing&&t.hide()}},_shiftKeypad:function(n){n.ucase=!n.ucase;this._updateKeypad(n);n._input.focus()},_clearValue:function(n){this._setValue(n,"",0);this._notifyKeypress(n,t.DEL)},_backValue:function(n){var r=n._input[0],u=n._input.val(),i=[u.length,u.length];i=n._input.prop("readonly")||n._input.prop("disabled")?i:r.setSelectionRange?[r.selectionStart,r.selectionEnd]:r.createTextRange?this._getIERange(r):i;this._setValue(n,u.length==0?"":u.substr(0,i[0]-1)+u.substr(i[1]),i[0]-1);this._notifyKeypress(n,t.BS)},_selectValue:function(n,t){this.insertValue(n._input[0],t);this._setValue(n,n._input.val());this._notifyKeypress(n,t)},insertValue:function(t,i){t=t.jquery?t:n(t);var r=t[0],f=t.val(),u=[f.length,f.length];u=t.attr("readonly")||t.attr("disabled")?u:r.setSelectionRange?[r.selectionStart,r.selectionEnd]:r.createTextRange?this._getIERange(r):u;t.val(f.substr(0,u[0])+i+f.substr(u[1]));pos=u[0]+i.length;t.is(":visible")&&t.focus();r.setSelectionRange?t.is(":visible")&&r.setSelectionRange(pos,pos):r.createTextRange&&(u=r.createTextRange(),u.move("character",pos),u.select())},_getIERange:function(n){var t,i;n.focus();t=document.selection.createRange().duplicate();i=this._getIETextRange(n);i.setEndPoint("EndToStart",t);var r=function(n){for(var t=n.text,i=t;;)if(n.compareEndPoints("StartToEnd",n)==0)break;else if(n.moveEnd("character",-1),n.text==t)i+="\r\n";else break;return i},u=r(i),f=r(t);return[u.length,u.length+f.length]},_getIETextRange:function(n){var t=n.nodeName.toLowerCase()=="input",i=t?n.createTextRange():document.body.createTextRange();return t||i.moveToElementText(n),i},_setValue:function(t,i){var r=t._input.attr("maxlength");r>-1&&(i=i.substr(0,r));t._input.val(i);n.isFunction(t.options.onKeypress)||t._input.trigger("change")},_notifyKeypress:function(t,i){n.isFunction(t.options.onKeypress)&&t.options.onKeypress.apply(t._input?t._input[0]:null,[i,t._input.val(),t])},_generateHTML:function(i){for(var e,u,f,o,s,r=i.options.prompt?'<div class="'+this._promptClass+(i.options.useThemeRoller?" ui-widget-header ui-corner-all":"")+'">'+i.options.prompt+"<\/div>":"",c=this._randomiseLayout(i),h=0;h<c.length;h++){for(r+='<div class="'+this._rowClass+'">',e=c[h].split(i.options.separator),u=0;u<e.length;u++)i.ucase&&(e[u]=i.options.toUpper(e[u])),f=this._specialKeys[e[u].charCodeAt(0)],r+=f?f.action?'<button type="button" class="'+this._specialClass+" "+this._namePrefixClass+f.name+(i.options.useThemeRoller?" ui-corner-all ui-state-default"+(f.noHighlight?"":" ui-state-highlight"):"")+'" title="'+i.options[f.name+"Status"]+'">'+(i.options[f.name+"Text"]||"&#160;")+"<\/button>":'<div class="'+this._namePrefixClass+f.name+'"><\/div>':'<button type="button" class="'+this._keyClass+(i.options.useThemeRoller?" ui-corner-all ui-state-default":"")+'">'+(e[u]==" "?"&#160;":e[u])+"<\/button>";r+="<\/div>"}return r=n(r),o=i,s=this._keyDownClass+(i.options.useThemeRoller?" ui-state-active":""),r.find("button").mousedown(function(){n(this).addClass(s)}).mouseup(function(){n(this).removeClass(s)}).mouseout(function(){n(this).removeClass(s)}).filter("."+this._keyClass).click(function(){t._selectValue(o,n(this).text())}),n.each(this._specialKeys,function(n,i){r.find("."+t._namePrefixClass+i.name).click(function(){i.action.apply(o._input,[o])})}),r},_randomiseLayout:function(n){var r,i,t;if(!n.options.randomiseNumeric&&!n.options.randomiseAlphabetic&&!n.options.randomiseOther&&!n.options.randomiseAll)return n.options.layout;var f=[],e=[],u=[],o=[];for(r=0;r<n.options.layout.length;r++)for(o[r]="",i=n.options.layout[r].split(n.options.separator),t=0;t<i.length;t++)this._isControl(i[t])||(n.options.randomiseAll?u.push(i[t]):n.options.isNumeric(i[t])?f.push(i[t]):n.options.isAlphabetic(i[t])?e.push(i[t]):u.push(i[t]));n.options.randomiseNumeric&&this._shuffle(f);n.options.randomiseAlphabetic&&this._shuffle(e);(n.options.randomiseOther||n.options.randomiseAll)&&this._shuffle(u);var h=0,c=0,s=0;for(r=0;r<n.options.layout.length;r++)for(i=n.options.layout[r].split(n.options.separator),t=0;t<i.length;t++)o[r]+=(this._isControl(i[t])?i[t]:n.options.randomiseAll?u[s++]:n.options.isNumeric(i[t])?f[h++]:n.options.isAlphabetic(i[t])?e[c++]:u[s++])+n.options.separator;return o},_isControl:function(n){return n<" "},isAlphabetic:function(n){return n>="A"&&n<="Z"||n>="a"&&n<="z"},isNumeric:function(n){return n>="0"&&n<="9"},toUpper:function(n){return n.toUpperCase()},_shuffle:function(n){for(var i,r,t=n.length-1;t>0;t--)i=Math.floor(Math.random()*n.length),r=n[t],n[t]=n[i],n[i]=r}});t=n.keypad;t.addKeyDef("CLOSE","close",function(n){t._curInst=n._inline?n:t._curInst;t.hide()});t.addKeyDef("CLEAR","clear",function(n){t._clearValue(n)});t.addKeyDef("BACK","back",function(n){t._backValue(n)});t.addKeyDef("SHIFT","shift",function(n){t._shiftKeypad(n)});t.addKeyDef("SPACE_BAR","spacebar",function(n){t._selectValue(n," ")},!0);t.addKeyDef("SPACE","space");t.addKeyDef("HALF_SPACE","half-space");t.addKeyDef("ENTER","enter",function(n){t._selectValue(n,"\r")},!0);t.addKeyDef("TAB","tab",function(n){t._selectValue(n,"\t")},!0);t.numericLayout=["123"+t.CLOSE,"456"+t.CLEAR,"789"+t.BACK,t.SPACE+"0"];t.qwertyLayout=["!@#$%^&*()_="+t.HALF_SPACE+t.SPACE+t.CLOSE,t.HALF_SPACE+"`~[]{}<>\\|/"+t.SPACE+"789","qwertyuiop'\""+t.HALF_SPACE+"456",t.HALF_SPACE+"asdfghjkl;:"+t.SPACE+"123",t.SPACE+"zxcvbnm,.?"+t.SPACE+t.HALF_SPACE+"-0+",""+t.TAB+t.ENTER+t.SPACE_BAR+t.SHIFT+t.HALF_SPACE+t.BACK+t.CLEAR];n.extend(t.regionalOptions[""],{alphabeticLayout:t.qwertyAlphabetic,fullLayout:t.qwertyLayout,isAlphabetic:t.isAlphabetic,isNumeric:t.isNumeric,toUpper:t.toUpper});t.setDefaults(n.extend({layout:t.numericLayout},t.regionalOptions[""]));n(function(){n(document.body).append(t.mainDiv).on("mousedown."+i,t._checkExternalClick)})})(jQuery);
//# sourceMappingURL=jquery.keypad.min.js.map
